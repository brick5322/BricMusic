# V3.0设计方案

经历了V2.0这次大翻新，BricMusic其实已经成为一个很可以用的播放软件了，但是现在并没有提供一种非常良好的线上支持，没有一种很成熟的机制来处理线上的资源。这个怎么说呢，我其实认为现在的BricMusic作为一款音乐播放器已经实现了她应有的所有内容，所以说V2.x版本（应该不会有太多版本了，主要问题还是集中在修复一些Bug）应该就是一个很完美的轻量级版本了。

实际上依托新版本FFMpeg，BricMusicV2.0已经可以支持http、rtmp等协议，苦于接口问题，并不能很好的解决BricMusic通过互联网获取mp3文件，即使可以支持http协议，却不能方便点获取url，不能实现网络支持的BricMusic，也算是一种缺憾吧。

现在想到的解决方案有两种。

## 1.为BricMusic添加Python支持

V3.0将考虑使用Python虚拟机来替代Lua虚拟机，这将一定会导致BricMusic内存臃肿，也是扩展中不可避免的问题，不过，使用Python的好处在于可以充分利用网上现有代码资源。

这样需要允许向`MenuList`填充闭包

添加Python大致需要对代码做出这些改动：

1. 首先是添加虚拟机的问题，Python虚拟机是全局的，所以应该会安排一个全局的单例对象来单独管理Python虚拟机。
2. 考虑到联网的延时，可能需要重构其他部分的代码。同时也要考虑是否可以通过预加载来减少卡顿。这样就要为Python单独分配一条线程，而这里又要注意GIL。
3. Python虚拟机是全局的，不可以通过卸载虚拟机来释放内存，所以也要考虑内存释放的问题。
4. 保存歌单文件
5. 链接

## 2.扩展当前.blu的功能



